{
    "app-id": "org.gtkx.flatpak",
    "runtime": "org.gnome.Platform",
    "runtime-version": "48",
    "sdk": "org.gnome.Sdk",
    "sdk-extensions": ["org.freedesktop.Sdk.Extension.node22"],
    "command": "gtkx-flatpak-demo",
    "finish-args": ["--share=ipc", "--socket=fallback-x11", "--socket=wayland", "--device=dri"],
    "build-options": {
        "append-path": "/usr/lib/sdk/node22/bin",
        "env": {
            "npm_config_nodedir": "/usr/lib/sdk/node22"
        },
        "no-debuginfo": true,
        "strip": false
    },
    "modules": [
        {
            "name": "flatpak-demo",
            "buildsystem": "simple",
            "build-options": {
                "build-args": ["--share=network"]
            },
            "build-commands": [
                "npm install",
                "npm run build",
                "npm run bundle",
                "node --experimental-sea-config sea-config.json",
                "cp /usr/lib/sdk/node22/bin/node gtkx-flatpak-demo",
                "npx postject gtkx-flatpak-demo NODE_SEA_BLOB dist/sea-prep.blob --sentinel-fuse NODE_SEA_FUSE_fce680ab2cc467b6e072b8b5df1996b2",
                "install -Dm755 gtkx-flatpak-demo /app/bin/gtkx-flatpak-demo",
                "install -Dm755 node_modules/@gtkx/native/dist/index.node /app/bin/index.node"
            ],
            "sources": [
                {
                    "type": "dir",
                    "path": ".",
                    "skip": [
                        ".flatpak-builder",
                        "build-dir",
                        "dist",
                        "node_modules",
                        "node-v22.12.0-linux-x64",
                        "node-v22.12.0-linux-x64.tar.xz",
                        "generated-sources.json",
                        "additional-sources.json"
                    ]
                }
            ]
        }
    ]
}
